# <%= name %> applications.yml
---
DEFAULTS: &DEFAULTS
  name: $LABEL
  config:
    endpoint: 'api.{domain}'
    deploy_tag: 'enable-api.'

<%= "#{name}: &#{name}" %>
  <<: *DEFAULTS
  type: Application::CnfsBackend
  services: cognito, comm, iam, organization, storage, sftp
  resources: app_bucket, image_bucket, dns, image_cdn
  config: &default_config
    endpoints:
      api: 'api.{domain}'
      sftp: 'sftp.{domain}'
  environment:
    rails_database_host: postgres
    # rails_database_user: admin
    # rails_database_password: admin
    redis_url: redis://redis:6379
    platform:
      api_docs:
        server:
          host: 'https://api.{domain}'
      connection:
        type: host
        external_connection_type: path
        # feature_set: mounted
        hosts: 'api.{domain}'
      jwt:
        aud: 'https://api.{domain}'
        iss: 'https://iam.api.{domain}'
      partition_name: ros
      postman:
        workspace: 'api.{domain}'
      storage:
        image:
          services: ['images']
        app:
          services: ['documents', 'reports', 'sftp']
